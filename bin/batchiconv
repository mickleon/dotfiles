#!/usr/bin/bash

INPUT_ENCODING="UTF-8"
OUTPUT_ENCODING="WINDOWS-1251"
OUTPUT_DIR="batchiconv_$OUTPUT_ENCODING"
REGEX="\./.*\.(cpp|h)"

if [ ! -d "$OUTPUT_DIR" ]; then
    mkdir "$OUTPUT_DIR"
fi

for file in $(find -maxdepth 1 -regextype egrep -iregex $REGEX )
do
    iconv $file -f $INPUT_ENCODING -t $OUTPUT_ENCODING > "$OUTPUT_DIR/$file"
done

